{"ts":1366585240770,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1366585340609,"patch":[[{"diffs":[[1,"class RegistrationsController < Devise::RegistrationsController\n\n  def new\n    @plan = params[:plan]\n    if @plan && ENV[\"ROLES\"].include?(@plan) && @plan != \"admin\"\n      super\n    else\n      redirect_to root_path, :notice => 'Please select a subscription plan below.'\n    end\n  end\n\n  private\n  def build_resource(*args)\n    super\n    if params[:plan]\n      resource.add_role(params[:plan])\n    end\n  end\nend"]],"start1":0,"start2":0,"length1":0,"length2":410}]],"length":410,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366680895565,"patch":[[{"diffs":[[0,"\n  end\n\n"],[1,"  def update_plan\n    @user = current_user\n    role = Role.find(params[:user][:role_ids]) unless params[:user][:role_ids].nil?\n    if @user.update_plan(role)\n      redirect_to edit_user_registration_path, :notice => 'Updated plan.'\n    else\n      flash.alert = 'Unable to update plan.'\n      render :edit\n    end\n  end\n\n  def update_card\n    @user = current_user\n    @user.stripe_token = params[:user][:stripe_token]\n    if @user.save\n      redirect_to edit_user_registration_path, :notice => 'Updated card.'\n    else\n      flash.alert = 'Unable to update card.'\n      render :edit\n    end\n  end\n\n"],[0,"  privat"]],"start1":277,"start2":277,"length1":16,"length2":613}]],"length":1007,"saved":false}
