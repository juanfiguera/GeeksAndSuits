{"ts":1366680880956,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"class UsersController < ApplicationController\n  before_filter :authenticate_user!\n\n  def index\n    authorize! :index, @user, :message => 'Not authorized as an administrator.'\n    @users = User.all\n  end\n\n  def show\n    @user = User.find(params[:id])\n  end\n  \n  def update\n    authorize! :update, @user, :message => 'Not authorized as an administrator.'\n    @user = User.find(params[:id])\n    if @user.update_attributes(params[:user], :as => :admin)\n      redirect_to users_path, :notice => \"User updated.\"\n    else\n      redirect_to users_path, :alert => \"Unable to update user.\"\n    end\n  end\n    \n  def destroy\n    authorize! :destroy, @user, :message => 'Not authorized as an administrator.'\n    user = User.find(params[:id])\n    unless user == current_user\n      user.destroy\n      redirect_to users_path, :notice => \"User deleted.\"\n    else\n      redirect_to users_path, :notice => \"Can't delete yourself.\"\n    end\n  end\nend"]],"start1":0,"start2":0,"length1":0,"length2":929}]],"length":929}
{"contributors":[],"silentsave":false,"ts":1366681231130,"patch":[[{"diffs":[[0,")\n  end\n"],[-1,"  "],[0,"\n"],[1,""],[0,"  def up"]],"start1":248,"start2":248,"length1":19,"length2":17},{"diffs":[[0,"    "],[-1,"if @user.update_attributes(params[:user], :as => :admin)"],[1,"role = Role.find(params[:user][:role_ids]) unless params[:user][:role_ids].nil?\n    params[:user] = params[:user].except(:role_ids)\n    if @user.update_attributes(params[:user])\n      @user.update_plan(role) unless role.nil?"],[0,"\n   "]],"start1":386,"start2":386,"length1":64,"length2":232},{"diffs":[[0,"d\n  end\n"],[-1,"    "],[0,"\n  def d"]],"start1":752,"start2":752,"length1":20,"length2":16}]],"length":1091,"saved":false}
